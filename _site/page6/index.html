<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      nxhelp.com &middot; by Thomas Uhde
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Droid+Serif:400,400italic,700|Droid+Sans:400">
  <link rel="stylesheet" href="http://weloveiconfonts.com/api/?family=entypo">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- Google Analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-146052-15', 'getpoole.com');
    ga('send', 'pageview');
  </script>
</head>


  <body class="theme-base-0d">

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox" checked>

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p></p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/about/">About</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/archive/">Archive</a>
        
      
    
      
    
      
    
      
        
          <a class="sidebar-nav-item" href="/projects/">Projects</a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    

    <a class="sidebar-nav-item" href="https://github.com/acidix/nxhelp">GitHub project</a>
    <span class="sidebar-nav-item">Currently v1.0.0</span>
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2014. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <label for="sidebar-checkbox" class="sidebar-toggle"></label>

          <h3 class="masthead-title">
            <a href="/" title="Home">nxhelp.com</a>
            <small>by Thomas Uhde</small>
          </h3>
        </div>
      </div>

      <div class="container content" id="container">
        <div class="posts">
  
  <div class="post">
  
  <h1 class="post-title post-title-blog">
	  <a href="/2011/11/08/accessing-icloud-from-google-calendar/">
	
        Accessing iCloud from Google Calendar
      </a>
    </h1>

    
    <span class="post-date">November 8th 2011</span>
    
    
    <span class="social">[ <a target="_blank" rel="nofollow" href="https://twitter.com/intent/tweet?original_referer=%2F2011%2F11%2F08%2Faccessing-icloud-from-google-calendar%2F&text=Accessing+iCloud+from+Google+Calendar&url=http%3A%2F%2Fnxhelp.com%2F%2F2011%2F11%2F08%2Faccessing-icloud-from-google-calendar%2F&via=ThomasUhde" title="Tweet this post">tweet</a> : <a target="_blank" rel="nofollow" href="https://alpha.app.net/intent/post?text=Accessing%20iCloud%20from%20Google%20Calendar%20%2D%20http%3A%2F%2Fnxhelp.com%2F%2F2011%2F11%2F08%2Faccessing-icloud-from-google-calendar%2F">adn</a>]</span>
    </span>
    
      
         <p>Accessing my iCloud Calendar from within Google Calendar was a major issue since my move to iCloud. Having said that, it&#39;s not even my own &quot;Backup&quot; setup on Google Apps that bothers me that    much, it&#39;s more about sharing my calendar with other family members that are not using iCloud.</p>

<h3>Getting Access - the easy part</h3>

<p>Getting access itself is, despite one small caveat, the easy task. You&#39;ll have to publicly share your calendar. WIthout public sharing only iCloud users will be able to access your calendar. Despite the fact that you&#39;ll share your calendar with the world - that&#39;s a minor pitfall to take.</p>

<h3>Getting Access - the problem ...</h3>

<p>However, if you now try to access your calendar from Google (replacing <code>webcal://</code> by <code>http://</code>), you&#39;ll be presented with the following error:</p>

<p><img style="display: block; margin-left: auto; margin-right: auto;" title="Screen Shot 2011-11-08 at 21.06.19.png" src="http://www.nxhelp.com/wp-content/uploads/2011/11/Screen-Shot-2011-11-08-at-21.06.19.png" border="0" alt="Screen    Shot 2011 11 08 at 21 06 19" width="459" height="111" /></p>

<p>The iCloud servers seem to prevent access from Google - probably mainly to avoid the Google servers crawling all public calendars, but with the drawback of keeping us from accessing our calendar. After a [post in the iCloud]{https://discussions.apple.com/message/16617386#16617386} forums I don&#39;t have much confidence this will be fixed soon … </p>

<h3>Solution 1 - the PHP script</h3>

<p>So, I thought there must be an easier way than relying on Apple to fix the problem. Actually, there were 2 solutions that came to my mind:</p>

<ul>
<li>Apache Reverse Proxy</li>
<li>A PHP script</li>
</ul>

<p>Saying that I know that the majority of people doesn&#39;t have an own (V-)Server to run an Apache instance they can actually configure. However, there are plenty of (free) providers that allow you to run PHP scripts.
The following script gets the calendar (via the public URL) from iCloud and presents it in a way that Google Calendar will be able to access it:</p>

<div class="highlight"><pre><code class="php"><span class="cp">&lt;?php</span>
<span class="c1">// Set error level reporting level</span>
<span class="nb">error_reporting</span><span class="p">(</span><span class="k">E_ERROR</span><span class="p">);</span>

<span class="c1">// create a new curl resource and set options</span>
<span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>

<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="s2">&quot;https://&lt;your iCloud feed&gt;&quot;</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_BINARYTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_FOLLOWLOCATION</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="c1">// grab URL, and return output</span>
<span class="nv">$output</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>

<span class="c1">// Send the header based on the response from the server</span>
<span class="nx">header</span><span class="p">(</span><span class="s1">&#39;Content-type: text/calendar&#39;</span><span class="p">);</span>
<span class="nx">header</span><span class="p">(</span><span class="s2">&quot;Cache-Control: no-cache, must-revalidate&quot;</span><span class="p">);</span> 

<span class="c1">// HTTP/1.1</span>
<span class="nx">header</span><span class="p">(</span><span class="s2">&quot;Expires: Sat, 26 Jul 1997 05:00:00 GMT&quot;</span><span class="p">);</span> 
<span class="c1">// Date in the past</span>

<span class="c1">// Send the curl output</span>
<span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$output</span><span class="p">))</span><span class="err"> </span> <span class="err"> </span> 
    <span class="k">echo</span> <span class="nb">var_dump</span><span class="p">(</span><span class="nv">$output</span><span class="p">);</span>
    <span class="k">else</span>
    <span class="err"> </span> <span class="err"> </span> <span class="k">echo</span> <span class="nv">$output</span><span class="p">;</span>
    
    <span class="c1">// close curl resource</span>
    <span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
    
<span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>

<h3>Solution 2 - mod_proxy</h3>

<p>The even easier solution (as long as you&#39;ve got your own configurable Apache instance) is using mod<em>proxy to use a simple HTTP Reverse Proxy to get the feed from the Apple Servers and redirect it. One pitfall though is that the iCloud access strictly requires https access, so we&#39;ll have to configure apache for ssl as well. This example is based on a RedHat 5.4 system, so adapt accordingly ...
     
First, install apache2 and mod</em>ssl</p>

<div class="highlight"><pre><code class="bash">yum install httpd mod_ssl
</code></pre></div>

<p>Next, we&#39;ll configure the SSL Engine:</p>

<div class="highlight"><pre><code class="bash">vi /etc/httpd/conf.d/ssl.conf

...
&lt;VirtualHost _default_:1443&gt;
SSLProxyEngine on
SSLOptions -StrictRequire
...
</code></pre></div>

<p>Having configured https and enabling the SSL Proxy option, we can now go ahead an get the actual ReverseProxy working:</p>

<div class="highlight"><pre><code class="bash">vi /etc/httpd/conf/httpd.conf
</code></pre></div>

<p>Add the following lines to the end of the file:</p>

<div class="highlight"><pre><code class="bash">ProxyRequests   off
SSLProxyEngine  on
    
&lt;Proxy *&gt;
   Order deny,allow
   Allow from all
&lt;/Proxy&gt;
    
<span class="c"># Set TCP/IP network buffer size for better throughput (bytes)</span>
ProxyReceiveBufferSize 4096
    
ProxyPass /ical/ https://p03-calendarws.icloud.com/
ProxyPassReverse /ical/ https://p03-calendarws.icloud.com/
</code></pre></div>

<p>Now, start the apache process:</p>

<div class="highlight"><pre><code class="bash">/etc/init.d/httpd start
</code></pre></div>

<p>You can now access your calendar by replacing the <code>webcal://p03-calendarws.icloud.com/</code> part of your public URL by <code>http(s)://yourserver/ical/</code>, making is something like <code>http://yourserver/ical/ca/subscribe/1/pY7JHjsAi</code> ...</p>

      
    
  </div>
  
  <div class="post">
  
  <h1 class="post-title post-title-blog">
	  <a href="/2011/11/01/macos-10-7-wake-reason-rtc-alarm/">
	
        MacOS 10.7: Wake reason RTC (Alarm)
      </a>
    </h1>

    
    <span class="post-date">November 1st 2011</span>
    
    
    <span class="social">[ <a target="_blank" rel="nofollow" href="https://twitter.com/intent/tweet?original_referer=%2F2011%2F11%2F01%2Fmacos-10-7-wake-reason-rtc-alarm%2F&text=MacOS+10.7:+Wake+reason+RTC+(Alarm)&url=http%3A%2F%2Fnxhelp.com%2F%2F2011%2F11%2F01%2Fmacos-10-7-wake-reason-rtc-alarm%2F&via=ThomasUhde" title="Tweet this post">tweet</a> : <a target="_blank" rel="nofollow" href="https://alpha.app.net/intent/post?text=MacOS%2010.7:%20Wake%20reason%20RTC%20(Alarm)%20%2D%20http%3A%2F%2Fnxhelp.com%2F%2F2011%2F11%2F01%2Fmacos-10-7-wake-reason-rtc-alarm%2F">adn</a>]</span>
    </span>
    
      
         <p>Ever since I upgraded to MacOS 10.7 (or OS 10.7 as you&#39;d call it nowadays) I noticed my machine periodically waking up from sleep without turning on the Monitor - and going back where it came from. While it&#39;s not a big deal, it is kind of annoying, so I wanted to get rid of it. A quick search for &quot;wake reason&quot; in Console revealed at least parts of the issue:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">01/11/2011 06:14:13.000 kernel: Wake reason: RTC (Alarm)
</code></pre></div>
<p>After a quick search I found the Knowledge Base Article that describes exactly my problem: <a href="http://support.apple.com/kb/HT3774?viewlocale=en_GB">About Wake on Demand</a></p>

<p>The reason for this odd behaviour is the Bonjour Sleep Proxy that is used to periodically advertise services of the machine to the network. While I had this turned off in 10.6, is was set to on automatically when I upgraded to 10.7. To shorten the article, the solution is to disable &quot;Wake on Network Access&quot; in the Energy Saving options.</p>

      
    
  </div>
  
  <div class="post">
  
  <h1 class="post-title post-title-blog">
	  <a href="/2011/10/24/steve-jobs-by-walter-isaacson/">
	
        Steve Jobs by Walter Isaacson
      </a>
    </h1>

    
    <span class="post-date">October 24th 2011</span>
    
    
    <span class="social">[ <a target="_blank" rel="nofollow" href="https://twitter.com/intent/tweet?original_referer=%2F2011%2F10%2F24%2Fsteve-jobs-by-walter-isaacson%2F&text=Steve+Jobs+by+Walter+Isaacson&url=http%3A%2F%2Fnxhelp.com%2F%2F2011%2F10%2F24%2Fsteve-jobs-by-walter-isaacson%2F&via=ThomasUhde" title="Tweet this post">tweet</a> : <a target="_blank" rel="nofollow" href="https://alpha.app.net/intent/post?text=Steve%20Jobs%20by%20Walter%20Isaacson%20%2D%20http%3A%2F%2Fnxhelp.com%2F%2F2011%2F10%2F24%2Fsteve-jobs-by-walter-isaacson%2F">adn</a>]</span>
    </span>
    
      
         <p><a href="http://www.nxhelp.com/wp-content/uploads/2011/10/Bildschirmfoto-2011-10-24-um-07.32.29.jpg"><img src="http://www.nxhelp.com/wp-content/uploads/2011/10/Bildschirmfoto-2011-10-24-um-07.32.29-300x252.jpg" alt=""></a></p>

<p>My copy was shipped by Amazon today. Can&#39;t wait for it to arrive.</p>

      
    
  </div>
  
  <div class="post">
  
  <h1 class="post-title post-title-blog">
	  <a href="/2011/10/21/my-perfect-exchange-on-linux-setup/">
	
        (My) Perfect Exchange on Linux setup
      </a>
    </h1>

    
    <span class="post-date">October 21st 2011</span>
    
    
    <span class="social">[ <a target="_blank" rel="nofollow" href="https://twitter.com/intent/tweet?original_referer=%2F2011%2F10%2F21%2Fmy-perfect-exchange-on-linux-setup%2F&text=(My)+Perfect+Exchange+on+Linux+setup&url=http%3A%2F%2Fnxhelp.com%2F%2F2011%2F10%2F21%2Fmy-perfect-exchange-on-linux-setup%2F&via=ThomasUhde" title="Tweet this post">tweet</a> : <a target="_blank" rel="nofollow" href="https://alpha.app.net/intent/post?text=(My)%20Perfect%20Exchange%20on%20Linux%20setup%20%2D%20http%3A%2F%2Fnxhelp.com%2F%2F2011%2F10%2F21%2Fmy-perfect-exchange-on-linux-setup%2F">adn</a>]</span>
    </span>
    
      
         <p>Given the fact that most companies still use Microsoft Exchange as their preferred E-Mail and Collaboration solution, we (running Linux and/or MacOS) see ourselves confronted with the same problem: <em>How to get E-Mails and Calendar entries with the least possible pain.</em></p>

<p>I want to share my current, well working, setup with you.</p>

<p><strong>Choosing a client</strong></p>

<p>I&#39;ve chosen Mozilla Thunderbird as my preferred client on the Linux desktop for E-Mail and Calendar.</p>

<p><strong>E-Mail</strong></p>

<p>I went for the usual setup: IMAP and SMTP directly to the Exchange server. The only (at least known to me) area where this damn thing is actually standards compliant.</p>

<p><strong>Calendaring</strong></p>

<p>I use the <a href="http://gitorious.org/lightning-exchange-provider/pages/Home">Exchange Data Provider for Lightning</a> for calendaring. Works like a charm. After using DavMail with all the ups and downs this is the most stable solution I&#39;ve used so far on Linux. Can only recommend it.</p>

<p><strong>Calendar syncing</strong></p>

<p>This goes for Google Calendar and/or iCloud. Syncing is a major factor for me as I want to have at least read-only access on my work calendar while I&#39;m on the road.</p>

<p>Also, I went for an extremely straight-forward setup. Using the <a href="http://www.sunbird-kalender.de/extension/autoexport/de/index.html">Automatic Export Plugin</a> for Thunderbird I just let it put a copy of my calendar exported to ICS into my Public folder in Dropbox. Using the &quot;Public URL&quot; feature I then subscribe to the calendar in read-only mode from Google Calendar and iCloud.</p>

<p>That&#39;s it! The easiest to configure and maintain setup I ever had. Man am I happy :)</p>

      
    
  </div>
  
  <div class="post">
  
  <h1 class="post-title post-title-blog">
	  <a href="/2011/10/11/db21015e-on-redhat-5-6/">
	
        DB21015E on RedHat 5.6
      </a>
    </h1>

    
    <span class="post-date">October 11th 2011</span>
    
    
    <span class="social">[ <a target="_blank" rel="nofollow" href="https://twitter.com/intent/tweet?original_referer=%2F2011%2F10%2F11%2Fdb21015e-on-redhat-5-6%2F&text=DB21015E+on+RedHat+5.6&url=http%3A%2F%2Fnxhelp.com%2F%2F2011%2F10%2F11%2Fdb21015e-on-redhat-5-6%2F&via=ThomasUhde" title="Tweet this post">tweet</a> : <a target="_blank" rel="nofollow" href="https://alpha.app.net/intent/post?text=DB21015E%20on%20RedHat%205.6%20%2D%20http%3A%2F%2Fnxhelp.com%2F%2F2011%2F10%2F11%2Fdb21015e-on-redhat-5-6%2F">adn</a>]</span>
    </span>
    
      
         <p>If you receive the following message trying to connect do a DB2 instance</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">[user@host ~]$ db2 connect to INSTANCE
 DB21015E The Command Line Processor backend process request queue or input
 queue was not created within the timeout period.
</code></pre></div>
<p>Looking into the strace output shows something like</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">msgget(0x416b94ef, IPC_CREAT|IPC_EXCL|0610) = -1 ENOSPC (No space left on device)
</code></pre></div>
<p>and db2diag.log shows</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">PID : 9999 TID : 47272606561216PROC : db2bp
 INSTANCE: INSANCE NODE : 000
 FUNCTION: DB2 UDB, oper system services, sqloMLNique, probe:8
 MESSAGE : ZRC=0x870F0043=-2029060029=SQLO_QUE_EXCEED
 &quot;Maximum system queue limit exceeded&quot;
 DIA8559C A message queue limit has been exceeded.
 CALLED : OS, -, msgget OSERR: ENOSPC (28)
</code></pre></div>
<p>Basically that means that</p>

<p><strong>a) In terms of shared Memory</strong>
all possible shared memory IDs have been taken (SHMMNI), or allocating a segment of the requested size would cause the system to exceed the system-wide limit on shared memory (SHMALL).</p>

<p><strong>b) In terms of Semaphores</strong>
A semaphore set has to be created but the system limit for the maximum number of semaphore sets (SEMMNI), or the system wide maximum number of semaphores (SEMMNS), would be exceeded.</p>

<p>(we&#39;ll get to the point that this is <em>not</em> our issue here ...)</p>

<p>Next step would be to check the system-wide values to see what we&#39;re looking for:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">$ ipcs -l




------ Shared Memory Limits --------
 max number of segments = 4096
 max seg size (kbytes) = 67108864
 max total shared memory (kbytes) = 17179869184
 min seg size (bytes) = 1




------ Semaphore Limits --------
 max number of arrays = 128
 max semaphores per array = 250
 max semaphores system wide = 32000
 max ops per semop call = 32
 semaphore max value = 32767




------ Messages: Limits --------
 max queues system wide = 16
 max size of message (bytes) = 65536
 default max size of queue (bytes) = 65536




$ sysctl -a | grep shm
 vm.hugetlb_shm_group = 0
 kernel.shmmni = 4096
 kernel.shmall = 4294967296
 kernel.shmmax = 68719476736
</code></pre></div>
<p>So we have a maximum of 4096 shared memory segments, 128 Semaphore Arrays and 250 Semaphores per Array available. Looks reasonably good so far.</p>

<p>The most concerning parameter in terms of DB2 is this one, and that goes well together with the msgget() system call:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">max queues system wide = 16
</code></pre></div>
<p>According to the DB2 Documentation, the maximum number of message queues (MSGMNI) has to be set to at least 16384. Also, the maximum number of Semaphore Arrays should be 1024.</p>

<p>OK, let&#39;s do it:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">sysctl -w kernel.msgmni=16384
sysctl -w kernel.sem=&quot;250 32000 100 1024&quot;
</code></pre></div>
<p>Et voila, it&#39;s working:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">$ db2 connect to INSTANCE




Database Connection Information




Database server = DB2/LINUXX8664 9.7.1
 SQL authorization ID = USER
 Local database alias = INSTANCE
</code></pre></div>
<p>Now, let&#39;s make the change persistent:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">echo &quot;kernel.msgmni=16384&quot; &gt;&gt;/etc/sysctl.conf
echo &quot;kernel.sem=\&quot;250 32000 100 1024\&quot;&quot; &gt;&gt;/etc/sysctl.conf
</code></pre></div>
<p>That&#39;s it! Now your DB2 adventures can begin ...</p>

<p>Note: Please see the <a href="(http://publib.boulder.ibm.com/infocenter/db2luw/v9r7/index.jsp?topic=%2Fcom.ibm.db2.luw.qb.server.doc%2Fdoc%2Ft0008238.html">official DB2 documentation</a>.</p>

      
    
  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page7">Older</a>
  
  
    
      <a class="pagination-item newer" href="/page5">Newer</a>
    
  
</div>

      </div>
    </div>

  </body>
</html>
